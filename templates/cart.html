<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Media Gallery - Cart</title>

    <style>
        /* Change the entire page background and default text color */
        body {
            background-color: #242424; /* Very dark grey background */
            color: #f0f0f0;            /* Light grey/white text for contrast */
            font-family: Arial, sans-serif;
            margin: 0; 
            padding: 20px;
        }

        table {
            border: 1px solid #555;
            border-collapse: collapse;
            margin: 20px auto;
        }
        
        th, td {
            border: 1px solid #555;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #444;
        }

        .thumbnail { 
            width: 300px; 
            height: auto; 
        }

        h1 {
            color: #ffffff;
            text-align: center;
        }
    </style>

</head>

<body>
    <h1><a href="{{ url_for('index') }}">MEDIA GALLERY</a></h1>

    <div style="position: absolute; top: 10px; right: 10px;">
        <a href="{{ url_for('cart') }}">ðŸ›’ ({{ session.get('cart', [])|length }})</a>
    </div>

    {% if not media %}
    <p style="text-align: center;">Cart is empty</p>
    {% endif %}

    {% if media %}
    <form method="POST" action="{{ url_for('download_cart') }}">
        <div style="text-align: center; margin: 20px;">
            <a href="{{ url_for('clear_cart') }}"><button type="button">Clear Cart</button></a>
            <button type="submit" id="downloadBtn" style="margin-left: 10px;">Download Selected</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Sel</th>
                    <th>Media</th>
                    <th>Subject</th>
                    <th>Lighting</th>
                    <th>Setting</th>
                    <th style="width: 40%;">Captions</th>
                </tr>
            </thead>
            <tbody>
                {% for media_item in media %}
                <tr>
                    <td><input type="checkbox" name="selected" value="{{ media_item['file_id'] }}" checked></td>
                    <td>
                        <img src="{{ url_for('static', filename=media_item['thumbnail_relative_path']) }}" 
                             alt="{{ media_item['file_name'] }}"
                             class="thumbnail">
                    </td>
                    <td>{{ media_item['subject'] }}</td>
                    <td>{{ media_item['lighting'] }}</td>
                    <td>{{ media_item['setting'] }}</td>
                    <td>{{ media_item['captions'] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div style="text-align: center; margin: 20px;">
            <a href="{{ url_for('clear_cart') }}"><button type="button">Clear Cart</button></a>
            <button type="submit" id="downloadBtn2" style="margin-left: 10px;">Download Selected</button>
        </div>
    </form>
    {% endif %}

    <script>
        const checkboxes = document.querySelectorAll('input[name="selected"]');
        const button1 = document.getElementById('downloadBtn');
        const button2 = document.getElementById('downloadBtn2');

        function updateButtons() {
            const checked = Array.from(checkboxes).some(cb => cb.checked);
            button1.disabled = !checked;
            button2.disabled = !checked;
        }

        if (checkboxes.length > 0) {
            checkboxes.forEach(cb => cb.addEventListener('change', updateButtons));
            updateButtons();
        }
    </script>

</body>
</html>